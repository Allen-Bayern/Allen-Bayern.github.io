{"version":3,"file":"js/article-page.46bffedb.js","mappings":"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","sources":["webpack://self-site/./src/articles/index.ts","webpack://self-site/./src/components/MarkDown/VueMarkdown.vue","webpack://self-site/./src/components/MarkDown/VueMarkdown.vue?aba2","webpack://self-site/./src/components/SomeHub/index.vue","webpack://self-site/./src/components/SomeHub/index.vue?a44a","webpack://self-site/./src/store/modules/ArticleStore.ts","webpack://self-site/./src/views/ArticleView.vue","webpack://self-site/./src/views/ArticleView.vue?84bb","webpack://self-site/./src/articles/ lazy \\.md$/"],"sourcesContent":["/** 导出文章类型 */\ninterface ArticleLazyReturn {\n    default: string;\n}\n\n/** @description 基本文章信息 */\nexport type BaseArticleMeta = Partial<{\n    /** @description 文章标题 */\n    artTitle: string;\n    /** @description 文章摘要 */\n    articleAbstract: string;\n    /** @description 创建时间 */\n    createTime: Date;\n    /** @description 最后修改时间 */\n    modifyTime: Date;\n}>;\n\n/**\n * @description 去掉文件名的前缀'./'与后缀'.md'\n * @param filePath 输入的文件path\n * @returns 纯净的文件名\n */\nconst pureName = (filePath: string): string =>\n    //       移除前缀 './'       &   移除后缀 '.md'\n    filePath.replace(/^\\.\\//, '').replace(/\\.md$/, '');\n\n/** @description 引入所有文章 */\nexport const importAllArticles = () => {\n    const articlesCxt = require.context('.', true, /\\.md$/i, 'lazy');\n    return articlesCxt.keys().reduce(\n        (prev, k) => ({\n            ...prev,\n            [pureName(k)]: articlesCxt(k),\n        }),\n        {} as Record<string, unknown>\n    ) as Record<string, Promise<ArticleLazyReturn>>;\n};\n","import { defineComponent as _defineComponent } from 'vue';\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nimport { ref, watchEffect, watch, onBeforeUnmount, onUnmounted } from 'vue';\nimport moment from 'moment';\nimport yaml from 'js-yaml';\nimport strFormat from 'string-format';\nimport { renderMarkdown, renderMarkdownAsync, useImmerVue as useImmer, globalTitle, YMD } from '@/utils';\n// --- props ---\nconst flush = 'post';\n// --- logics ---\n// ref dom\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'VueMarkdown',\n  props: {\n    mdString: {},\n    isAsync: {\n      type: Boolean,\n      default: () => true\n    },\n    isSetTitle: {\n      type: Boolean,\n      default: () => true\n    }\n  },\n  setup(__props) {\n    // Vue 解析 markdown 组件\n    const props = __props;\n    // --- constants ---\n    const domRef = ref(null);\n    // html string\n    const htmlStr = ref('');\n    const [metaInfo, updateMetaInfo] = useImmer({});\n    /**\n     * @description 解析文章meta信息\n     * @param metaStr 文章的yml字符串\n     */\n    function onParseFrontMeta(metaStr) {\n      const res = yaml.load(metaStr);\n      updateMetaInfo(res);\n    }\n    // to get HTML string\n    const stopMdEffect = watchEffect(() => {\n      // watchEffect中可以安全解构props\n      const {\n        mdString,\n        isAsync\n      } = props;\n      if (isAsync) {\n        renderMarkdownAsync(mdString, {\n          onParseFrontMeta\n        }).then(res => {\n          if (domRef.value) {\n            htmlStr.value = res;\n          }\n        });\n      } else {\n        if (domRef.value) {\n          htmlStr.value = renderMarkdown(mdString, {\n            onParseFrontMeta\n          });\n        }\n      }\n    }, {\n      flush\n    });\n    // to set innerHTML\n    const stopParseHtmlEffect = watch([() => htmlStr.value, () => metaInfo.value, () => props.isSetTitle], ([newHtmlStr, newMetaInfo, newSetTitle]) => {\n      const {\n        artTitle\n      } = newMetaInfo;\n      // parse h1\n      const h1Pattern = /<h1>(.*?)<\\/h1>/;\n      const h1Match = newHtmlStr.match(h1Pattern);\n      const h1Content = h1Match ? h1Match[1] : '';\n      // rest html\n      let realHtmlStr = newHtmlStr.replace(h1Pattern, '');\n      // templates\n      const oneDomTemp = '<div class=\"meta-info-item\"><p class=\"meta-info-item-p\">{}</p><p class=\"meta-info-item-p\">{}</p></div>\\n';\n      // 处理meta key-value函数\n      const metaLabelToValue = (metaDict, k) => {\n        if (['createTime', 'modifyTime'].includes(k)) {\n          return moment(metaDict[k]).format(YMD);\n        }\n        return String(metaDict[k]);\n      };\n      // 仅解析两个日期键\n      const metaInfoSelfDom = ['createTime', 'modifyTime'].reduce((prev, k) => {\n        let label = '';\n        if (k === 'createTime') {\n          label = '创建日期:';\n        } else if (k === 'modifyTime') {\n          label = '最后修改于';\n        }\n        const oneDom = strFormat(oneDomTemp, label, metaLabelToValue(newMetaInfo, k));\n        return `${prev}${oneDom}`;\n      }, '');\n      const metaInfoPart = `<div class=\"meta-info\">${metaInfoSelfDom}</div>`;\n      // 如无h1Content, 则以artTitle作为h1内容\n      realHtmlStr = `<h1 class=\"the-article-title\">${h1Content || artTitle}</h1>${metaInfoPart}${realHtmlStr}`;\n      if (domRef.value) {\n        domRef.value.innerHTML = realHtmlStr;\n        if (newSetTitle) {\n          // 设置document.title时，artTitle的优先级更大一些\n          const newTitle = artTitle || h1Content;\n          document.title = newTitle ? `${newTitle}-${globalTitle}` : globalTitle;\n        }\n      }\n    }, {\n      flush\n    });\n    // fix: before unmount时, 重置标题\n    onBeforeUnmount(() => {\n      document.title = globalTitle;\n    });\n    // clear watcher\n    onUnmounted(() => {\n      stopMdEffect();\n      stopParseHtmlEffect();\n    });\n    return (_ctx, _cache) => {\n      return _openBlock(), _createElementBlock(\"div\", {\n        class: \"vue-markdown\",\n        ref_key: \"domRef\",\n        ref: domRef\n      }, null, 512);\n    };\n  }\n});","/* unplugin-vue-components disabled */import script from \"./VueMarkdown.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./VueMarkdown.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./VueMarkdown.vue?vue&type=style&index=0&id=465b95b4&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-5c4b43a7\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"some-hub-part\"\n};\nconst _hoisted_2 = {\n  class: \"some-hub-part\"\n};\nimport { computed } from 'vue';\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  props: {\n    leftPart: {\n      default() {\n        return 'Git';\n      }\n    },\n    rightPart: {\n      default() {\n        return 'Hub';\n      }\n    },\n    isBlock: {\n      type: Boolean,\n      default() {\n        return true;\n      }\n    }\n  },\n  setup(__props) {\n    // 模仿GitHub的组件\n    const props = __props;\n    // 计算classList\n    const classList = computed(() => {\n      const {\n        isBlock = true\n      } = props;\n      const res = ['some-hub'];\n      if (!isBlock) {\n        return [...res, 'no-block'];\n      }\n      return res;\n    });\n    return (_ctx, _cache) => {\n      return _openBlock(), _createElementBlock(\"div\", {\n        class: _normalizeClass(classList.value)\n      }, [_createElementVNode(\"p\", _hoisted_1, _toDisplayString(_ctx.leftPart), 1), _createElementVNode(\"p\", _hoisted_2, _toDisplayString(_ctx.rightPart), 1)], 2);\n    };\n  }\n});","/* unplugin-vue-components disabled */import script from \"./index.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./index.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./index.vue?vue&type=style&index=0&id=5c4b43a7&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-5c4b43a7\"]])\n\nexport default __exports__","import { defineStore } from 'pinia';\nimport { importAllArticles } from '@/articles';\n\n// 引入文章集\nconst allArticles = importAllArticles();\n\n/** @description 获取文章的store */\nconst useArticleStore = defineStore('articleStore', {\n    state() {\n        return {\n            // 当前article id\n            currentArticleId: '',\n            // 当前article\n            currentArticle: '',\n        };\n    },\n    actions: {\n        async getArticle(articleId: string) {\n            if (Object.keys(allArticles).includes(articleId)) {\n                this.currentArticleId = articleId;\n                // 懒加载文章\n                const articleCnt = await allArticles[articleId];\n                this.currentArticle = articleCnt?.default;\n\n                return;\n            }\n\n            throw new Error('');\n        },\n    },\n});\n\n/** @description 文章store */\nexport default useArticleStore;\n","import \"core-js/modules/es.array.push.js\";\nimport { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, openBlock as _openBlock, createBlock as _createBlock } from \"vue\";\nimport { watch, watchEffect, onUnmounted } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport { VueMarkdown } from '@/components';\nimport { storeToRefs } from 'pinia';\nimport { useArticleStore } from '@/store/modules';\n// constants\nconst flush = 'post';\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'ArticleView',\n  setup(__props) {\n    const route = useRoute();\n    const router = useRouter();\n    // 处理store逻辑\n    const articleStore = useArticleStore();\n    const {\n      currentArticle,\n      currentArticleId\n    } = storeToRefs(articleStore);\n    const {\n      getArticle\n    } = articleStore;\n    // 解构query\n    const {\n      query: routeQuery\n    } = route;\n    // 获取文章主逻辑\n    const stopParseQuery = watchEffect(() => {\n      /** @description 以 ?article=xxx 为解析参数 */\n      const {\n        article\n      } = routeQuery;\n      currentArticleId.value = typeof article === 'string' ? article : '';\n    }, {\n      flush\n    });\n    // 获取article\n    const stopGetArticle = watch(() => currentArticleId.value, newValue => {\n      getArticle(newValue).catch(() => {\n        router.push('/404');\n      });\n    }, {\n      flush\n    });\n    onUnmounted(() => {\n      stopParseQuery();\n      stopGetArticle();\n    });\n    return (_ctx, _cache) => {\n      return _openBlock(), _createBlock(_unref(VueMarkdown), {\n        class: \"article-view\",\n        \"md-string\": _unref(currentArticle),\n        \"is-async\": false\n      }, null, 8, [\"md-string\"]);\n    };\n  }\n});","/* unplugin-vue-components disabled */import script from \"./ArticleView.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./ArticleView.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./ArticleView.vue?vue&type=style&index=0&id=b2164200&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-b2164200\"]])\n\nexport default __exports__","var map = {\n\t\"./HelloWorld.md\": [\n\t\t4614,\n\t\t614\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function() { return Object.keys(map); };\nwebpackAsyncContext.id = 6367;\nmodule.exports = webpackAsyncContext;"],"names":["pureName","filePath","replace","importAllArticles","articlesCxt","require","keys","reduce","prev","k","flush","__name","props","mdString","isAsync","type","Boolean","default","isSetTitle","setup","__props","domRef","htmlStr","metaInfo","updateMetaInfo","onParseFrontMeta","metaStr","res","stopMdEffect","then","value","stopParseHtmlEffect","newHtmlStr","newMetaInfo","newSetTitle","artTitle","h1Pattern","h1Match","match","h1Content","realHtmlStr","oneDomTemp","metaLabelToValue","metaDict","includes","format","String","metaInfoSelfDom","label","oneDom","metaInfoPart","innerHTML","newTitle","document","title","_ctx","_cache","class","ref_key","ref","__exports__","_hoisted_1","_hoisted_2","leftPart","rightPart","isBlock","classList","allArticles","useArticleStore","defineStore","state","currentArticleId","currentArticle","actions","getArticle","articleId","Object","Error","this","articleCnt","route","router","articleStore","query","routeQuery","stopParseQuery","article","stopGetArticle","newValue","catch","push","map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","e","code","ids","id","module","exports"],"sourceRoot":""}